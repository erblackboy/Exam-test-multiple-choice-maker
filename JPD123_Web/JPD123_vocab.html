<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JPD123 - T·ª´ v·ª±ng B√†i 4-7 (Theo List PDF)</title>
    <style>
        :root {
            --primary-color: #007bff;
            --primary-hover: #0056b3;
            --success-color: #28a745;
            --danger-color: #dc3545;
            --warning-color: #ffc107;
            --light-bg: #f8f9fa;
            --white-bg: #ffffff;
            --text-color: #333;
            --border-color: #dee2e6;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background-color: var(--light-bg);
            color: var(--text-color);
            line-height: 1.6;
            margin: 0;
            padding: 20px;
        }
        .container {
            max-width: 800px;
            margin: auto;
            background: var(--white-bg);
            padding: 20px 30px;
            border-radius: 12px;
            box-shadow: 0 6px 20px rgba(0,0,0,0.08);
        }
        .main-menu {
            text-align: center;
            margin-bottom: 25px;
            padding-bottom: 25px;
            border-bottom: 1px solid var(--border-color);
        }
        .main-menu button {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 12px 25px;
            margin: 5px 10px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: 500;
            transition: all 0.2s ease-in-out;
        }
        .main-menu button:hover {
            background-color: var(--primary-hover);
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(0, 123, 255, 0.3);
        }
        .main-menu button.active {
            background-color: var(--primary-hover);
        }
        .view { display: none; }
        .view.active { display: block; animation: fadeIn 0.5s; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        h1, h2, h3 { color: var(--primary-hover); text-align: center; }

        /* Vocab View */
        #filter-container {
            text-align: center;
            margin: -10px 0 20px 0;
            padding: 10px;
            background-color: #f8f9fa;
            border-radius: 8px;
        }
        #filter-container label {
            margin: 0 15px;
            font-size: 1.05em;
            cursor: pointer;
        }
         #filter-container input {
            margin-right: 5px;
            vertical-align: middle;
        }
        .lesson-group {
            margin-bottom: 25px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            background-color: #fdfdfd;
            overflow: hidden;
        }
        .lesson-group h3 {
            margin: 0;
            padding: 15px 20px;
            color: white;
            background-color: #6c757d;
        }
        .vocab-list { list-style: none; padding: 0; margin: 0; }
        .vocab-item { display: flex; justify-content: space-between; align-items: center; padding: 12px 20px; border-bottom: 1px solid var(--border-color); }
        .vocab-item:last-child { border-bottom: none; }
        .vocab-jp { font-size: 1.15em; font-weight: 500; }
        .vocab-jp .kana { font-size: 0.85em; color: #555; font-weight: normal; display: block; }
        /* Style for ruby/rt (furigana) */
        ruby {
            font-size: 1em; /* Adjust base text size if needed */
            ruby-position: over;
        }
        rt {
            font-size: 0.65em; /* Make furigana smaller */
            color: #666;
            user-select: none; /* Prevent selecting furigana */
            line-height: 1.1;
        }
        .vocab-vi { font-size: 1.05em; color: #444; text-align: right; }

        /* Quiz View */
        #quiz-status { text-align: center; margin-bottom: 20px; font-size: 1.1em; }
        #progress-bar-container { background-color: #e9ecef; border-radius: 0.25rem; }
        #progress-bar { height: 10px; background-color: var(--success-color); border-radius: 0.25rem; transition: width 0.4s ease; }
        #quiz-container { padding: 20px; background: #fdfdfd; border-radius: 8px; border: 1px solid var(--border-color); }
        #question { font-size: 1.6em; font-weight: bold; margin-bottom: 25px; text-align: center; }
        #options { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; margin-bottom: 20px; }
        #options button { width: 100%; padding: 18px; font-size: 1.1em; cursor: pointer; background-color: var(--white-bg); border: 1px solid var(--border-color); border-radius: 8px; transition: all 0.2s; text-align: left; }
        #options button:hover:not(:disabled) { border-color: var(--primary-color); color: var(--primary-color); background-color: #e9f7ff; }
        #options button.correct { background-color: var(--success-color); color: white; border-color: var(--success-color); }
        #options button.incorrect { background-color: var(--danger-color); color: white; border-color: var(--danger-color); }
        #options button:disabled { cursor: default; }
        #explanation { display: none; margin-top: 20px; padding: 20px; background-color: #e9f7ff; border: 1px solid #bce8f1; border-radius: 8px; }
        #explanation h4 { margin-top: 0; color: #31708f; border-bottom: 1px solid #bce8f1; padding-bottom: 10px; }
        #explanation p { margin: 8px 0; font-size: 1.1em; }
        #explanation .jp-sentence { font-weight: bold; font-size: 1.2em; }
        #explanation .romaji-sentence { font-style: italic; color: #555; }
        #quiz-controls { text-align: center; margin-top: 20px; }
        #quiz-controls button {
            background-color: var(--warning-color); color: #333; border: none; padding: 12px 30px;
            border-radius: 8px; cursor: pointer; font-size: 1.1em; font-weight: 500;
        }
        #quiz-complete-message { text-align: center; font-size: 1.3em; color: var(--success-color); }
        #reset-progress { background-color: #6c757d; color: white; margin-left: 10px;}
    </style>
</head>
<body>

    <div class="container">
        <h1>üáØüáµ Luy·ªán thi Ti·∫øng Nh·∫≠t üáªüá≥</h1>
        <div class="main-menu">
            <button id="show-vocab-btn" class="active">üìö Tra c·ª©u T·ª´ v·ª±ng</button>
            <button id="show-quiz-btn">‚úçÔ∏è √în t·∫≠p Tr·∫Øc nghi·ªám</button>
        </div>

        <div id="vocab-view" class="view active">
            <h2>Danh s√°ch T·ª´ v·ª±ng (B√†i 4-7)</h2>
            <div id="filter-container">
                <label><input type="checkbox" name="vocab-filter" value="kanji"> Kanji</label>
                <label><input type="checkbox" name="vocab-filter" value="hiragana"> Hiragana</label>
                <label><input type="checkbox" name="vocab-filter" value="katakana"> Katakana</label>
            </div>
            <div id="vocab-content"></div>
        </div>

        <div id="quiz-view" class="view">
            <h2>√în t·∫≠p Tr·∫Øc nghi·ªám</h2>
            <div id="quiz-status">
                <p>Ti·∫øn ƒë·ªô: <span id="completed-count">0</span> / <span id="total-count">0</span></p>
                <div id="progress-bar-container">
                    <div id="progress-bar" style="width: 0%;"></div>
                </div>
            </div>

            <div id="quiz-start-screen">
                 <div id="quiz-controls">
                    <button id="start-quiz-session-btn">B·∫Øt ƒë·∫ßu phi√™n √¥n t·∫≠p (10 c√¢u)</button>
                    <button id="reset-progress">Reset ti·∫øn ƒë·ªô</button>
                </div>
            </div>

            <div id="quiz-container" style="display: none;">
                <div id="question"></div>
                <div id="options"></div>
                <div id="explanation">
                    <h4>üìñ Gi·∫£i th√≠ch chi ti·∫øt</h4>
                    <p><strong>Kanji:</strong> <span id="exp-kanji"></span></p>
                    <p><strong>Hiragana/Katakana:</strong> <span id="exp-kana"></span></p>
                    <p><strong>Romaji:</strong> <span id="exp-romaji"></span></p>
                    <p><strong>Nghƒ©a:</strong> <span id="exp-vi"></span></p>
                    <hr>
                    <p><strong>C√¢u v√≠ d·ª•:</strong></p>
                    <p class="jp-sentence" id="exp-sentence-jp"></p>
                    <p class="romaji-sentence" id="exp-sentence-romaji"></p>
                    <p class="vi-sentence" id="exp-sentence-vi"></p>
                </div>
                <div id="quiz-session-controls" style="text-align:center; margin-top:20px;">
                    <button id="next-question-btn" style="display:none;">C√¢u ti·∫øp theo</button>
                </div>
            </div>

             <div id="quiz-complete-message" style="display:none;">
                <h3>üéâ Ch√∫c m·ª´ng! B·∫°n ƒë√£ ho√†n th√†nh t·∫•t c·∫£ c√¢u h·ªèi!</h3>
                <p>H√£y nh·∫•n n√∫t Reset ƒë·ªÉ b·∫Øt ƒë·∫ßu l·∫°i t·ª´ ƒë·∫ßu.</p>
            </div>

        </div>
    </div>

<script>
// D·ªÆ LI·ªÜU T·ª™ V·ª∞NG T·ª™ PDF LIST (CH∆Ø∆†N 4-7) - CORRECTED
const vocabulary = [
    // B√ÄI 4 (T·ª´ List PDF)
    { id: 401, lesson: 4, kanji: "Âåó", hiragana: "„Åç„Åü", romaji: "kita", vietnamese: "b·∫Øc" },
    { id: 402, lesson: 4, kanji: "Âçó", hiragana: "„Åø„Å™„Åø", romaji: "minami", vietnamese: "nam" },
    { id: 403, lesson: 4, kanji: "Êù±", hiragana: "„Å≤„Åå„Åó", romaji: "higashi", vietnamese: "ƒë√¥ng" },
    { id: 404, lesson: 4, kanji: "Ë•ø", hiragana: "„Å´„Åó", romaji: "nishi", vietnamese: "t√¢y" },
    { id: 405, lesson: 4, kanji: "Áúü„Çì‰∏≠", hiragana: "„Åæ„Çì„Å™„Åã", romaji: "mannaka", vietnamese: "gi·ªØa" },
    { id: 406, lesson: 4, kanji: "Ëªä", hiragana: "„Åè„Çã„Åæ", romaji: "kuruma", vietnamese: "xe √¥-t√¥" },
    { id: 407, lesson: 4, kanji: "Êñ∞ÂππÁ∑ö", hiragana: "„Åó„Çì„Åã„Çì„Åõ„Çì", romaji: "shinkansen", vietnamese: "t√†u si√™u t·ªëc" },
    { id: 408, lesson: 4, kanji: "ÈõªËªä", hiragana: "„Åß„Çì„Åó„ÇÉ", romaji: "densha", vietnamese: "t√†u ƒëi·ªán" },
    { id: 409, lesson: 4, kanji: "È£õË°åÊ©ü", hiragana: "„Å≤„Åì„ÅÜ„Åç", romaji: "hikouki", vietnamese: "m√°y bay" },
    { id: 410, lesson: 4, kanji: "ÈßÖ", hiragana: "„Åà„Åç", romaji: "eki", vietnamese: "nh√† ga" },
    { id: 411, lesson: 4, kanji: "Áî∫", hiragana: "„Åæ„Å°", romaji: "machi", vietnamese: "khu ph·ªë, th√†nh ph·ªë" },
    { id: 412, lesson: 4, kanji: "ÊôÇÈñì", hiragana: "„Åò„Åã„Çì", romaji: "jikan", vietnamese: "-ti·∫øng" },
    { id: 413, lesson: 4, kanji: "ÊôÇÈñìÂçä", hiragana: "„Åò„Åã„Çì„ÅØ„Çì", romaji: "jikanhan", vietnamese: "ti·∫øng r∆∞·ª°i" },
    { id: 414, lesson: 4, kanji: "ÂàÜ", hiragana: "„Åµ„ÇìÔºè„Å∑„Çì", romaji: "fun/pun", vietnamese: "-ph√∫t" },
    { id: 415, lesson: 4, kanji: "Ê≠©„ÅÑ„Å¶", hiragana: "„ÅÇ„Çã„ÅÑ„Å¶", romaji: "aruite", vietnamese: "ƒëi b·ªô" },
    { id: 416, lesson: 4, hiragana: "„Åè„Çâ„ÅÑ", romaji: "kurai", vietnamese: "kho·∫£ng-" },
    { id: 417, lesson: 4, hiragana: "„Å©„ÅÆ„Åè„Çâ„ÅÑ", romaji: "donokurai", vietnamese: "kho·∫£ng bao nhi√™u" },
    { id: 418, lesson: 4, kanji: "Ê∏©Ê≥â", hiragana: "„Åä„Çì„Åõ„Çì", romaji: "onsen", vietnamese: "su·ªëi n∆∞·ªõc n√≥ng" },
    { id: 419, lesson: 4, kanji: "Â∑ù", hiragana: "„Åã„Çè", romaji: "kawa", vietnamese: "s√¥ng" },
    { id: 420, lesson: 4, kanji: "Â±±", hiragana: "„ÇÑ„Åæ", romaji: "yama", vietnamese: "n√∫i" },
    { id: 421, lesson: 4, kanji: "Êïô‰ºö", hiragana: "„Åç„Çá„ÅÜ„Åã„ÅÑ", romaji: "kyoukai", vietnamese: "nh√† th·ªù" },
    { id: 422, lesson: 4, kanji: "Âüé", hiragana: "„Åó„Çç", romaji: "(o)shiro", vietnamese: "l√¢u ƒë√†i, th√†nh" },
    { id: 423, lesson: 4, kanji: "Á•ûÁ§æ", hiragana: "„Åò„Çì„Åò„ÇÉ", romaji: "jinja", vietnamese: "ƒë·ªÅn th·ªù ƒë·∫°o Th·∫ßn" },
    { id: 424, lesson: 4, kanji: "ÂØ∫", hiragana: "„Å¶„Çâ", romaji: "(o)tera", vietnamese: "ch√πa" },
    { id: 425, lesson: 4, katakana: "„Éì„É´", romaji: "biru", vietnamese: "t√≤a nh√† nhi·ªÅu t·∫ßng" },
    { id: 426, lesson: 4, hiragana: "„Å®„Åì„Çç", romaji: "tokoro", vietnamese: "ch·ªó" },
    { id: 427, lesson: 4, kanji: "‰∫∫", hiragana: "„Å≤„Å®", romaji: "hito", vietnamese: "ng∆∞·ªùi" },
    { id: 428, lesson: 4, kanji: "Á∑ë", hiragana: "„Åø„Å©„Çä", romaji: "midori", vietnamese: "m√†u xanh l√° c√¢y" },
    { id: 429, lesson: 4, hiragana: "„ÅÇ„Çä„Åæ„Åô", romaji: "arimasu", vietnamese: "c√≥" },
    { id: 430, lesson: 4, kanji: "Êñ∞„Åó„ÅÑ", hiragana: "„ÅÇ„Åü„Çâ„Åó„ÅÑ", romaji: "atarashii", vietnamese: "m·ªõi" },
    { id: 431, lesson: 4, kanji: "Âè§„ÅÑ", hiragana: "„Åµ„Çã„ÅÑ", romaji: "furui", vietnamese: "c≈©" },
    { id: 432, lesson: 4, hiragana: "„ÅÑ„ÅÑ", romaji: "ii", vietnamese: "t·ªët, ƒë∆∞·ª£c" },
    { id: 433, lesson: 4, kanji: "ÊÇ™„ÅÑ", hiragana: "„Çè„Çã„ÅÑ", romaji: "warui", vietnamese: "x·∫•u" },
    { id: 434, lesson: 4, kanji: "Â§ö„ÅÑ", hiragana: "„Åä„Åä„ÅÑ", romaji: "ooi", vietnamese: "nhi·ªÅu (ÔΩû„Åå)" },
    { id: 435, lesson: 4, kanji: "Â∞ë„Å™„ÅÑ", hiragana: "„Åô„Åè„Å™„ÅÑ", romaji: "sukunai", vietnamese: "√≠t (ÔΩû„Åå)" },
    { id: 436, lesson: 4, kanji: "Â§ß„Åç„ÅÑ", hiragana: "„Åä„Åä„Åç„ÅÑ", romaji: "ookii", vietnamese: "to" },
    { id: 437, lesson: 4, kanji: "Â∞è„Åï„ÅÑ", hiragana: "„Å°„ÅÑ„Åï„ÅÑ", romaji: "chiisai", vietnamese: "nh·ªè" },
    { id: 438, lesson: 4, kanji: "È´ò„ÅÑ", hiragana: "„Åü„Åã„ÅÑ", romaji: "takai", vietnamese: "cao, ƒë·∫Øt" },
    { id: 439, lesson: 4, kanji: "‰Ωé„ÅÑ", hiragana: "„Å≤„Åè„ÅÑ", romaji: "hikui", vietnamese: "th·∫•p" },
    { id: 440, lesson: 4, hiragana: "„Åç„Çå„ÅÑ", romaji: "kirei(na)", vietnamese: "ƒë·∫πp, s·∫°ch" },
    { id: 441, lesson: 4, kanji: "Èùô„Åã", hiragana: "„Åó„Åö„Åã", romaji: "shizuka(na)", vietnamese: "y√™n tƒ©nh" },
    { id: 442, lesson: 4, hiragana: "„Å´„Åé„ÇÑ„Åã", romaji: "nigiyaka(na)", vietnamese: "n√°o nhi·ªát" },
    { id: 443, lesson: 4, kanji: "ÊúâÂêç", hiragana: "„ÇÜ„ÅÜ„ÇÅ„ÅÑ", romaji: "yuumei(na)", vietnamese: "n·ªïi ti·∫øng" },
    { id: 444, lesson: 4, hiragana: "„Å©„Çì„Å™", romaji: "donna", vietnamese: "th·∫ø n√†o" },
    { id: 445, lesson: 4, hiragana: "„Åù„Åó„Å¶", romaji: "soshite", vietnamese: "v√†" },
    { id: 446, lesson: 4, kanji: "Èõ®", hiragana: "„ÅÇ„ÇÅ", romaji: "ame", vietnamese: "m∆∞a" },
    { id: 447, lesson: 4, kanji: "Èõ™", hiragana: "„ÇÜ„Åç", romaji: "yuki", vietnamese: "tuy·∫øt" },
    { id: 448, lesson: 4, kanji: "Êó•", hiragana: "„Å≤", romaji: "hi", vietnamese: "ng√†y" },
    { id: 449, lesson: 4, katakana: "„É°„É≠„É≥", romaji: "meron", vietnamese: "d∆∞a l√™" },
    { id: 450, lesson: 4, kanji: "Êöñ„Åã„ÅÑ", hiragana: "„ÅÇ„Åü„Åü„Åã„ÅÑ", romaji: "atatakai", vietnamese: "·∫•m (th·ªùi ti·∫øt)" },
    { id: 451, lesson: 4, kanji: "Ê∂º„Åó„ÅÑ", hiragana: "„Åô„Åö„Åó„ÅÑ", romaji: "suzushii", vietnamese: "m√°t" },
    { id: 452, lesson: 4, kanji: "Êöë„ÅÑ", hiragana: "„ÅÇ„Å§„ÅÑ", romaji: "atsui", vietnamese: "n√≥ng (th·ªùi ti·∫øt)" },
    { id: 453, lesson: 4, kanji: "ÂØí„ÅÑ", hiragana: "„Åï„ÇÄ„ÅÑ", romaji: "samui", vietnamese: "l·∫°nh (th·ªùi ti·∫øt)" },
    { id: 454, lesson: 4, kanji: "Â§©Ê∞ó„Åå„ÅÑ„ÅÑ", hiragana: "„Å¶„Çì„Åç„Åå„ÅÑ„ÅÑ", romaji: "tenki ga ii", vietnamese: "tr·ªùi ƒë·∫πp" },
    { id: 455, lesson: 4, kanji: "Â§©Ê∞ó„ÅåÊÇ™„ÅÑ", hiragana: "„Å¶„Çì„Åç„Åå„Çè„Çã„ÅÑ", romaji: "tenki ga warui", vietnamese: "tr·ªùi x·∫•u" },
    { id: 456, lesson: 4, kanji: "Ê∏©„Åã„ÅÑ", hiragana: "„ÅÇ„Åü„Åü„Åã„ÅÑ", romaji: "atatakai", vietnamese: "·∫•m (ƒë·ªì v·∫≠t)" },
    { id: 457, lesson: 4, kanji: "ÁÜ±„ÅÑ", hiragana: "„ÅÇ„Å§„ÅÑ", romaji: "atsui", vietnamese: "n√≥ng (ƒë·ªì v·∫≠t)" },
    { id: 458, lesson: 4, kanji: "ÂÜ∑„Åü„ÅÑ", hiragana: "„Å§„ÇÅ„Åü„ÅÑ", romaji: "tsumetai", vietnamese: "l·∫°nh (ƒë·ªì v·∫≠t)" },
    { id: 459, lesson: 4, hiragana: "„Åä„ÅÑ„Åó„ÅÑ", romaji: "oishii", vietnamese: "ngon" },
    { id: 460, lesson: 4, hiragana: "„Åæ„Åö„ÅÑ", romaji: "mazui", vietnamese: "d·ªü" },
    { id: 461, lesson: 4, kanji: "Áîò„ÅÑ", hiragana: "„ÅÇ„Åæ„ÅÑ", romaji: "amai", vietnamese: "ng·ªçt" },
    { id: 462, lesson: 4, kanji: "Ëæõ„ÅÑ", hiragana: "„Åã„Çâ„ÅÑ", romaji: "karai", vietnamese: "cay" },
    { id: 463, lesson: 4, kanji: "Ëã¶„ÅÑ", hiragana: "„Å´„Åå„ÅÑ", romaji: "nigai", vietnamese: "ƒë·∫Øng" },
    { id: 464, lesson: 4, hiragana: "„Åô„Å£„Å±„ÅÑ", romaji: "suppai", vietnamese: "chua" },
    { id: 465, lesson: 4, kanji: "‰∏ÄÂπ¥‰∏≠", hiragana: "„ÅÑ„Å°„Å≠„Çì„Åò„ÇÖ„ÅÜ", romaji: "ichinenjuu", vietnamese: "c·∫£ nƒÉm" },
    { id: 466, lesson: 4, hiragana: "„ÅÇ„Åæ„Çä", romaji: "amari", vietnamese: "(kh√¥ng) l·∫Øm" },
    { id: 467, lesson: 4, kanji: "Â∞ë„Åó", hiragana: "„Åô„Åì„Åó", romaji: "sukoshi", vietnamese: "√≠t" },
    { id: 468, lesson: 4, hiragana: "„Å®„Å¶„ÇÇ", romaji: "totemo", vietnamese: "r·∫•t" },
    { id: 469, lesson: 4, hiragana: "„Å©„ÅÜ", romaji: "dou", vietnamese: "th·∫ø n√†o" },
    { id: 470, lesson: 4, hiragana: "„Åù„ÅÜ„Åß„Åô„Å≠", romaji: "sou desu ne", vietnamese: "v√¢ng, ƒë√∫ng th·∫ø" },
    { id: 471, lesson: 4, hiragana: "„Åü„Åè„Åï„Çì", romaji: "takusan", vietnamese: "nhi·ªÅu" },

    // B√ÄI 5 (T·ª´ List PDF)
    { id: 501, lesson: 5, kanji: "‰ªäÊó•", hiragana: "„Åç„Çá„ÅÜ", romaji: "kyou", vietnamese: "h√¥m nay" },
    { id: 502, lesson: 5, kanji: "ÊòéÊó•", hiragana: "„ÅÇ„Åó„Åü", romaji: "ashita", vietnamese: "ng√†y mai" },
    { id: 503, lesson: 5, hiragana: "„ÅÇ„Åï„Å£„Å¶", romaji: "asatte", vietnamese: "ng√†y kia" },
    { id: 504, lesson: 5, kanji: "Êò®Êó•", hiragana: "„Åç„ÅÆ„ÅÜ", romaji: "kinou", vietnamese: "h√¥m qua" },
    { id: 505, lesson: 5, hiragana: "„Åä„Å®„Å®„ÅÑ", romaji: "ototoi", vietnamese: "h√¥m kia" },
    { id: 506, lesson: 5, kanji: "ÂÖàÈÄ±", hiragana: "„Åõ„Çì„Åó„ÇÖ„ÅÜ", romaji: "senshuu", vietnamese: "tu·∫ßn tr∆∞·ªõc" },
    { id: 507, lesson: 5, kanji: "ÈÄ±Êú´", hiragana: "„Åó„ÇÖ„ÅÜ„Åæ„Å§", romaji: "shuumatsu", vietnamese: "cu·ªëi tu·∫ßn" },
    { id: 508, lesson: 5, kanji: "ÂÆ∂", hiragana: "„ÅÑ„Åà", romaji: "ie / uchi", vietnamese: "nh√†" },
    { id: 509, lesson: 5, kanji: "ÈÉ®Â±ã", hiragana: "„Å∏„ÇÑ", romaji: "heya", vietnamese: "ph√≤ng" },
    { id: 510, lesson: 5, katakana: "„Éá„Éë„Éº„Éà", romaji: "depaato", vietnamese: "b√°ch h√≥a" },
    { id: 511, lesson: 5, kanji: "ÁæéË°ìÈ§®", hiragana: "„Å≥„Åò„ÇÖ„Å§„Åã„Çì", romaji: "bijutsukan", vietnamese: "b·∫£o t√†ng m·ªπ thu·∫≠t" },
    { id: 512, lesson: 5, katakana: "„Ç≤„Éº„É†", romaji: "geemu", vietnamese: "tr√≤ ch∆°i" },
    { id: 513, lesson: 5, kanji: "ÂÆ∂Êóè", hiragana: "„Åã„Åû„Åè", romaji: "kazoku", vietnamese: "gia ƒë√¨nh" },
    { id: 514, lesson: 5, kanji: "ÊÅã‰∫∫", hiragana: "„Åì„ÅÑ„Å≥„Å®", romaji: "koibito", vietnamese: "ng∆∞·ªùi y√™u" },
    { id: 515, lesson: 5, kanji: "ÂèãÈÅî", hiragana: "„Å®„ÇÇ„Å†„Å°", romaji: "tomodachi", vietnamese: "b·∫°n" },
    { id: 516, lesson: 5, katakana: "„É´„Éº„É†„É°„Ç§„Éà", romaji: "ruumumeito", vietnamese: "b·∫°n c√πng ph√≤ng" },
    { id: 517, lesson: 5, hiragana: "„Å©„Åì„Åã(„Å∏)", romaji: "dokoka(e)", vietnamese: "(ƒëi) ƒë√¢u ƒë√≥" },
    { id: 518, lesson: 5, kanji: "‰ºö„ÅÑ„Åæ„Åô", hiragana: "„ÅÇ„ÅÑ„Åæ„Åô", romaji: "aimasu", vietnamese: "g·∫∑p" },
    { id: 519, lesson: 5, kanji: "‰Ωú„Çä„Åæ„Åô", hiragana: "„Å§„Åè„Çä„Åæ„Åô", romaji: "tsukurimasu", vietnamese: "l√†m, t·∫°o ra" },
    { id: 520, lesson: 5, kanji: "Ë≤∑„ÅÑÁâ©„Éª„Åó„Åæ„Åô", hiragana: "„Åã„ÅÑ„ÇÇ„ÅÆ„Éª„Åó„Åæ„Åô", romaji: "kaimono shimasu", vietnamese: "mua h√†ng" },
    { id: 521, lesson: 5, kanji: "È£ü‰∫ã„Éª„Åó„Åæ„Åô", hiragana: "„Åó„Çá„Åè„Åò„Éª„Åó„Åæ„Åô", romaji: "shokuji shimasu", vietnamese: "ƒÉn" },
    { id: 522, lesson: 5, kanji: "Ê¥óÊøØ„Éª„Åó„Åæ„Åô", hiragana: "„Åõ„Çì„Åü„Åè„Éª„Åó„Åæ„Åô", romaji: "sentaku shimasu", vietnamese: "gi·∫∑t" },
    { id: 523, lesson: 5, kanji: "ÊéÉÈô§„Éª„Åó„Åæ„Åô", hiragana: "„Åù„ÅÜ„Åò„Éª„Åó„Åæ„Åô", romaji: "souji shimasu", vietnamese: "d·ªçn v·ªá sinh" },
    { id: 524, lesson: 5, hiragana: "„Åù„Çå„Åã„Çâ", romaji: "sorekara", vietnamese: "sau ƒë√≥" },
    { id: 525, lesson: 5, kanji: "‰∏Ä‰∫∫„Åß", hiragana: "„Å≤„Å®„Çä„Åß", romaji: "hitoride", vietnamese: "m·ªôt m√¨nh" },
    { id: 526, lesson: 5, kanji: "‰ªäÊúù", hiragana: "„Åë„Åï", romaji: "kesa", vietnamese: "s√°ng nay" },
    { id: 527, lesson: 5, kanji: "ÂÖàÊúà", hiragana: "„Åõ„Çì„Åí„Å§", romaji: "sengetsu", vietnamese: "th√°ng tr∆∞·ªõc" },
    { id: 528, lesson: 5, kanji: "ÂéªÂπ¥", hiragana: "„Åç„Çá„Å≠„Çì", romaji: "kyonen", vietnamese: "nƒÉm ngo√°i" },
    { id: 529, lesson: 5, kanji: "È¢®ÈÇ™", hiragana: "„Åã„Åú", romaji: "kaze", vietnamese: "b·ªánh c√∫m" },
    { id: 530, lesson: 5, kanji: "Â§©Ê∞ó", hiragana: "„Å¶„Çì„Åç", romaji: "tenki", vietnamese: "th·ªùi ti·∫øt" },
    { id: 531, lesson: 5, kanji: "Êô©„ÅîÈ£Ø", hiragana: "„Å∞„Çì„Åî„ÅØ„Çì", romaji: "bangohan", vietnamese: "c∆°m t·ªëi" },
    { id: 532, lesson: 5, kanji: "Êúç", hiragana: "„Åµ„Åè", romaji: "fuku", vietnamese: "qu·∫ßn √°o" },
    { id: 533, lesson: 5, kanji: "Áôª„Çä„Åæ„Åô", hiragana: "„ÅÆ„Åº„Çä„Åæ„Åô", romaji: "noborimasu", vietnamese: "leo" },
    { id: 534, lesson: 5, kanji: "ÂÖ•„Çä„Åæ„Åô", hiragana: "„ÅØ„ÅÑ„Çä„Åæ„Åô", romaji: "hairimasu", vietnamese: "v√†o" },
    { id: 535, lesson: 5, kanji: "Âøô„Åó„ÅÑ", hiragana: "„ÅÑ„Åù„Åå„Åó„ÅÑ", romaji: "isogashii", vietnamese: "b·∫≠n" },
    { id: 536, lesson: 5, kanji: "Èù¢ÁôΩ„ÅÑ", hiragana: "„Åä„ÇÇ„Åó„Çç„ÅÑ", romaji: "omoshiroi", vietnamese: "th√∫ v·ªã" },
    { id: 537, lesson: 5, kanji: "Ê∞óÊåÅ„Å°„Åå„ÅÑ„ÅÑ", hiragana: "„Åç„ÇÇ„Å°„Åå„ÅÑ„ÅÑ", romaji: "kimochi ga ii", vietnamese: "d·ªÖ ch·ªãu" },
    { id: 538, lesson: 5, kanji: "È´ò„ÅÑ", hiragana: "„Åü„Åã„ÅÑ", romaji: "takai", vietnamese: "ƒë·∫Øt" },
    { id: 539, lesson: 5, kanji: "ÂÆâ„ÅÑ", hiragana: "„ÇÑ„Åô„ÅÑ", romaji: "yasui", vietnamese: "r·∫ª" },
    { id: 540, lesson: 5, kanji: "Ê•Ω„Åó„ÅÑ", hiragana: "„Åü„ÅÆ„Åó„ÅÑ", romaji: "tanoshii", vietnamese: "vui" },
    { id: 541, lesson: 5, kanji: "Èõ£„Åó„ÅÑ", hiragana: "„ÇÄ„Åö„Åã„Åó„ÅÑ", romaji: "muzukashii", vietnamese: "kh√≥" },
    { id: 542, lesson: 5, kanji: "Á∞°Âçò", hiragana: "„Åã„Çì„Åü„Çì", romaji: "kantan(na)", vietnamese: "ƒë∆°n gi·∫£n" },
    { id: 543, lesson: 5, kanji: "Â§ßÂ§â", hiragana: "„Åü„ÅÑ„Å∏„Çì", romaji: "taihen(na)", vietnamese: "v·∫•t v·∫£" },
    { id: 544, lesson: 5, kanji: "Êöá", hiragana: "„Å≤„Åæ", romaji: "hima(na)", vietnamese: "nh√†n r·ªói" },
    { id: 545, lesson: 5, hiragana: "„Å©„ÅÜ„Åó„Å¶", romaji: "doushite", vietnamese: "t·∫°i sao" },
    { id: 546, lesson: 5, kanji: "‰ªäÂ∫¶", hiragana: "„Åì„Çì„Å©", romaji: "kondo", vietnamese: "l·∫ßn t·ªõi" },
    { id: 547, lesson: 5, kanji: "‰ªäÊô©", hiragana: "„Åì„Çì„Å∞„Çì", romaji: "konban", vietnamese: "t·ªëi nay" },
    { id: 548, lesson: 5, kanji: "‰ªäÂπ¥", hiragana: "„Åì„Å®„Åó", romaji: "kotoshi", vietnamese: "nƒÉm nay" },
    { id: 549, lesson: 5, kanji: "Êù•Âπ¥", hiragana: "„Çâ„ÅÑ„Å≠„Çì", romaji: "rainen", vietnamese: "sang nƒÉm" },
    { id: 550, lesson: 5, katakana: "„Ç¢„Éã„É°", romaji: "anime", vietnamese: "phim ho·∫°t h√¨nh" },
    { id: 551, lesson: 5, kanji: "Áµµ", hiragana: "„Åà", romaji: "e", vietnamese: "b·ª©c tranh" },
    { id: 552, lesson: 5, kanji: "ÊôØËâ≤", hiragana: "„Åë„Åó„Åç", romaji: "keshiki", vietnamese: "phong c·∫£nh" },
    { id: 553, lesson: 5, kanji: "Ëá™Ëª¢Ëªä", hiragana: "„Åò„Å¶„Çì„Åó„ÇÉ", romaji: "jitensha", vietnamese: "xe ƒë·∫°p" },
    { id: 554, lesson: 5, kanji: "ÂÜôÁúü", hiragana: "„Åó„ÇÉ„Åó„Çì", romaji: "shashin", vietnamese: "b·ª©c ·∫£nh" },
    { id: 555, lesson: 5, kanji: "ÊíÆ„Çä„Åæ„Åô", hiragana: "„Å®„Çä„Åæ„Åô", romaji: "torimasu", vietnamese: "ch·ª•p" },
    { id: 556, lesson: 5, kanji: "ÂÄü„Çä„Åæ„Åô", hiragana: "„Åã„Çä„Åæ„Åô", romaji: "karimasu", vietnamese: "m∆∞·ª£n" },
    { id: 557, lesson: 5, hiragana: "„Åª„Åó„ÅÑ", romaji: "hoshii", vietnamese: "mu·ªën" },
    { id: 558, lesson: 5, kanji: "Â•Ω„Åç", hiragana: "„Åô„Åç", romaji: "suki(na)", vietnamese: "th√≠ch" },
    { id: 559, lesson: 5, kanji: "Â´å„ÅÑ", hiragana: "„Åç„Çâ„ÅÑ", romaji: "kirai(na)", vietnamese: "gh√©t" },
    { id: 560, lesson: 5, kanji: "ÂØÆ", hiragana: "„Çä„Çá„ÅÜ", romaji: "ryou", vietnamese: "k√Ω t√∫c x√°" },
    { id: 561, lesson: 5, hiragana: "„ÅÑ„Çç„ÅÑ„Çç", romaji: "iroiro(na)", vietnamese: "nhi·ªÅu" },
    { id: 562, lesson: 5, hiragana: "„Åæ„Åü", romaji: "mata", vietnamese: "l·∫°i" },
    { id: 563, lesson: 5, hiragana: "„Åù„Çå„ÅØ„Çà„Åã„Å£„Åü„Åß„Åô„Å≠", romaji: "sore wa yokatta desu ne", vietnamese: "Th·∫ø th√¨ t·ªët nh·ªâ." },
    { id: 564, lesson: 5, kanji: "Ëøë„Åè", hiragana: "„Å°„Åã„Åè", romaji: "chikaku", vietnamese: "g·∫ßn" },
    { id: 565, lesson: 5, kanji: "‰∏ÄÊó•", hiragana: "„ÅÑ„Å°„Å´„Å°", romaji: "ichinichi", vietnamese: "m·ªôt ng√†y" },

    // B√ÄI 6 (T·ª´ List PDF)
    { id: 601, lesson: 6, kanji: "‰ªäÈÄ±", hiragana: "„Åì„Çì„Åó„ÇÖ„ÅÜ", romaji: "konshuu", vietnamese: "tu·∫ßn n√†y" },
    { id: 602, lesson: 6, kanji: "Êù•ÈÄ±", hiragana: "„Çâ„ÅÑ„Åó„ÇÖ„ÅÜ", romaji: "raishuu", vietnamese: "tu·∫ßn sau" },
    { id: 603, lesson: 6, kanji: "‰ªäÊúà", hiragana: "„Åì„Çì„Åí„Å§", romaji: "kongetsu", vietnamese: "th√°ng n√†y" },
    { id: 604, lesson: 6, kanji: "Êù•Êúà", hiragana: "„Çâ„ÅÑ„Åí„Å§", romaji: "raigetsu", vietnamese: "th√°ng sau" },
    { id: 605, lesson: 6, katakana: "„Ç´„É©„Ç™„Ç±", romaji: "karaoke", vietnamese: "karaoke" },
    { id: 606, lesson: 6, katakana: "„Ç≥„É≥„Çµ„Éº„Éà", romaji: "konsaato", vietnamese: "bu·ªïi h√≤a nh·∫°c" },
    { id: 607, lesson: 6, kanji: "Ë©¶Âêà", hiragana: "„Åó„ÅÇ„ÅÑ", romaji: "shiai", vietnamese: "tr·∫≠n ƒë·∫•u" },
    { id: 608, lesson: 6, katakana: "„Çª„Éº„É´", romaji: "seeru", vietnamese: "b√°n h·∫° gi√°" },
    { id: 609, lesson: 6, katakana: "„ÉÅ„Ç±„ÉÉ„Éà", romaji: "chiketto", vietnamese: "v√©" },
    { id: 610, lesson: 6, kanji: "Âú∞Âõ≥", hiragana: "„Å°„Åö", romaji: "chizu", vietnamese: "b·∫£n ƒë·ªì" },
    { id: 611, lesson: 6, katakana: "„Éâ„É©„Ç§„Éñ", romaji: "doraibu", vietnamese: "l√°i √¥-t√¥ ƒëi ch∆°i" },
    { id: 612, lesson: 6, kanji: "Ê∞¥ÁùÄ", hiragana: "„Åø„Åö„Åé", romaji: "mizugi", vietnamese: "qu·∫ßn √°o t·∫Øm" },
    { id: 613, lesson: 6, kanji: "ÈáéÁêÉ", hiragana: "„ÇÑ„Åç„ÇÖ„ÅÜ", romaji: "yakyuu", vietnamese: "b√≥ng ch√†y" },
    { id: 614, lesson: 6, kanji: "Á¥ÑÊùü", hiragana: "„ÇÑ„Åè„Åù„Åè", romaji: "yakusoku", vietnamese: "h·∫πn" },
    { id: 615, lesson: 6, kanji: "Áî®‰∫ã", hiragana: "„Çà„ÅÜ„Åò", romaji: "youji", vietnamese: "c√¥ng chuy·ªán" },
    { id: 616, lesson: 6, kanji: "Êûö", hiragana: "„Åæ„ÅÑ", romaji: "mai", vietnamese: "-c√°i (ƒë·∫øm v·∫≠t m·ªèng)" },
    { id: 617, lesson: 6, kanji: "ÊÆãÂøµ", hiragana: "„Åñ„Çì„Å≠„Çì", romaji: "zannen(na)", vietnamese: "ti·∫øc" },
    { id: 618, lesson: 6, kanji: "‰∏ÄÁ∑í", hiragana: "„ÅÑ„Å£„Åó„Çá", romaji: "issho ni", vietnamese: "c√πng" },
    { id: 619, lesson: 6, hiragana: "„ÅÑ„ÅÑ„Åß„Åô„Å≠", romaji: "ii desu ne", vietnamese: "th√≠ch nh·ªâ, ƒë∆∞·ª£c r·ªìi" },
    { id: 620, lesson: 6, hiragana: "„ÅÇ„ÅÇ", romaji: "aa", vietnamese: "√îi" },
    { id: 621, lesson: 6, hiragana: "„Åô„Åø„Åæ„Åõ„Çì", romaji: "sumimasen", vietnamese: "xin l·ªói" },
    { id: 622, lesson: 6, kanji: "‰ªäÂ∫¶", hiragana: "„Åì„Çì„Å©", romaji: "mata kondo", vietnamese: "h·∫πn l·∫ßn t·ªõi" },
    { id: 623, lesson: 6, kanji: "È£ü„ÅπÁâ©", hiragana: "„Åü„Åπ„ÇÇ„ÅÆ", romaji: "tabemono", vietnamese: "ƒë·ªì ƒÉn" },
    { id: 624, lesson: 6, kanji: "È£≤„ÅøÁâ©", hiragana: "„ÅÆ„Åø„ÇÇ„ÅÆ", romaji: "nomimono", vietnamese: "ƒë·ªì u·ªëng" },
    { id: 625, lesson: 6, kanji: "ÁÑº„ÅçËÇâ", hiragana: "„ÇÑ„Åç„Å´„Åè", romaji: "yakiniku", vietnamese: "th·ªãt n∆∞·ªõng" },
    { id: 626, lesson: 6, katakana: "„É©„Éº„É°„É≥", romaji: "raamen", vietnamese: "m√¨" },
    { id: 627, lesson: 6, kanji: "È£ü„ÅπÊîæÈ°å", hiragana: "„Åü„Åπ„Åª„ÅÜ„Å†„ÅÑ", romaji: "tabehoudai", vietnamese: "ƒÉn th·ªèa th√≠ch" },
    { id: 628, lesson: 6, katakana: "„Ç≥„Éº„Çπ", romaji: "koosu", vietnamese: "lo·∫°t/b·ªô m√≥n ƒÉn" },
    { id: 629, lesson: 6, kanji: "Â±ÖÈÖíÂ±ã", hiragana: "„ÅÑ„Åñ„Åã„ÇÑ", romaji: "izakaya", vietnamese: "qu√°n r∆∞·ª£u" },
    { id: 630, lesson: 6, kanji: "Êò†ÁîªÈ§®", hiragana: "„Åà„ÅÑ„Åå„Åã„Çì", romaji: "eigakan", vietnamese: "r·∫°p chi·∫øu phim" },
    { id: 631, lesson: 6, kanji: "Âú∞‰∏ãÈâÑ", hiragana: "„Å°„Åã„Å¶„Å§", romaji: "chikatetsu", vietnamese: "t√†u ƒëi·ªán ng·∫ßm" },
    { id: 632, lesson: 6, kanji: "Ê≠åÊâã", hiragana: "„Åã„Åó„ÇÖ", romaji: "kashu", vietnamese: "ca sƒ©" },
    { id: 633, lesson: 6, kanji: "Â≠£ÁØÄ", hiragana: "„Åç„Åõ„Å§", romaji: "kisetsu", vietnamese: "m√πa" },
    { id: 634, lesson: 6, katakana: "„Ç≥„É°„Éá„Ç£„Éº", romaji: "komedii", vietnamese: "phim h√†i, di·ªÖn vi√™n h√†i" },
    { id: 635, lesson: 6, katakana: "„Ç∏„É£„Ç∫", romaji: "jazu", vietnamese: "nh·∫°c jazz" },
    { id: 636, lesson: 6, katakana: "„ÉÑ„Ç¢„Éº", romaji: "tsuaa", vietnamese: "tua" },
    { id: 637, lesson: 6, hiragana: "„Å©„Å°„Çâ", romaji: "dochira", vietnamese: "c√°i n√†o (trong hai)" },
    { id: 638, lesson: 6, hiragana: "„Å©„Å°„Çâ„ÇÇ", romaji: "dochira mo", vietnamese: "c√°i n√†o c≈©ng ƒë∆∞·ª£c" },
    { id: 639, lesson: 6, kanji: "Ëøë„ÅÑ", hiragana: "„Å°„Åã„ÅÑ", romaji: "chikai", vietnamese: "g·∫ßn" },
    { id: 640, lesson: 6, kanji: "ÈÅ†„ÅÑ", hiragana: "„Å®„Åä„ÅÑ", romaji: "tooi", vietnamese: "xa" },
    { id: 641, lesson: 6, kanji: "Êó©„ÅÑ", hiragana: "„ÅØ„ÇÑ„ÅÑ", romaji: "hayai", vietnamese: "s·ªõm" },
    { id: 642, lesson: 6, kanji: "Â∫É„ÅÑ", hiragana: "„Å≤„Çç„ÅÑ", romaji: "hiroi", vietnamese: "r·ªông" },
    { id: 643, lesson: 6, hiragana: "„ÅÑ„Å°„Å∞„Çì", romaji: "ichiban", vietnamese: "nh·∫•t, s·ªë m·ªôt" },
    { id: 644, lesson: 6, kanji: "ÂÖ®ÈÉ®", hiragana: "„Åú„Çì„Å∂", romaji: "zenbu", vietnamese: "to√†n b·ªô" },
    { id: 645, lesson: 6, hiragana: "„Åù„ÅÜ„Åß„Åô„Å≠„Åà", romaji: "sou desu nee", vietnamese: "√†, v√¢ng... (khi ƒëang suy nghƒ©)" },
    { id: 646, lesson: 6, kanji: "„ÅäÂ•Ω„ÅøÁÑº„Åç", hiragana: "„Åä„Åì„ÅÆ„Åø„ÇÑ„Åç", romaji: "okonomiyaki", vietnamese: "b√°nh x√®o Nh·∫≠t" },
    { id: 647, lesson: 6, hiragana: "„Åô„Åç„ÇÑ„Åç", romaji: "sukiyaki", vietnamese: "l·∫©u Sukiyaki" },
    { id: 648, lesson: 6, kanji: "ÈÅä„Å≥„Åæ„Åô", hiragana: "„ÅÇ„Åù„Å≥„Åæ„Åô", romaji: "asobimasu", vietnamese: "ch∆°i" },
    { id: 649, lesson: 6, hiragana: "„Åú„Å≤", romaji: "zehi", vietnamese: "nh·∫•t ƒë·ªãnh" },
    { id: 650, lesson: 6, hiragana: "„Åæ„Å†", romaji: "mada", vietnamese: "ch∆∞a" },
    { id: 651, lesson: 6, hiragana: "„ÇÇ„ÅÜ", romaji: "mou", vietnamese: "r·ªìi" },
    { id: 652, lesson: 6, hiragana: "„Çè„ÅÇ", romaji: "waa", vietnamese: "√îi (ng·∫°c nhi√™n)" },
    { id: 653, lesson: 6, hiragana: "„Åù„ÅÜ„Åó„Åæ„Åó„Çá„ÅÜ", romaji: "sou shimashou", vietnamese: "ch√∫ng ta l√†m th·∫ø nh√©" },
    { id: 654, lesson: 6, kanji: "ÂàÜ„Åã„Çä„Åæ„Åó„Åü", hiragana: "„Çè„Åã„Çä„Åæ„Åó„Åü", romaji: "wakarimashita", vietnamese: "hi·ªÉu r·ªìi" },
    { id: 655, lesson: 6, kanji: "Â∫ó", hiragana: "„Åø„Åõ", romaji: "(o)mise", vietnamese: "c·ª≠a h√†ng" },
    { id: 656, lesson: 6, kanji: "Ê•Ω„Åó„Åø„Åß„Åô", hiragana: "„Åü„ÅÆ„Åó„Åø„Åß„Åô", romaji: "tanoshimi desu", vietnamese: "t√¥i mong ƒë·ª£i ƒëi·ªÅu ƒë√≥" },
    { id: 657, lesson: 6, hiragana: "„Çà„Åã„Å£„Åü", romaji: "yokatta", vietnamese: "t·ªët" },

    // B√ÄI 7 (T·ª´ List PDF)
    { id: 701, lesson: 7, kanji: "ÊîπÊú≠", hiragana: "„Åã„ÅÑ„Åï„Å§", romaji: "kaisatsu", vietnamese: "so√°t v√©" },
    { id: 702, lesson: 7, kanji: "Êú®", hiragana: "„Åç", romaji: "ki", vietnamese: "c√¢y" },
    { id: 703, lesson: 7, kanji: "‰∫§Áï™", hiragana: "„Åì„ÅÜ„Å∞„Çì", romaji: "kouban", vietnamese: "ƒë·ªìn c·∫£nh s√°t" },
    { id: 704, lesson: 7, kanji: "Ëá™ÂãïË≤©Â£≤Ê©ü", hiragana: "„Åò„Å©„ÅÜ„ÅØ„Çì„Å∞„ÅÑ„Åç", romaji: "jidouhanbaiki", vietnamese: "m√°y b√°n t·ª± ƒë·ªông" },
    { id: 705, lesson: 7, kanji: "„Éê„ÇπÂÅú", hiragana: "„Éê„Çπ„Å¶„ÅÑ", romaji: "basutei", vietnamese: "ƒëi·ªÉm ƒë·ªó xe bu√Ωt" },
    { id: 706, lesson: 7, katakana: "„Éù„Çπ„Éà", romaji: "posuto", vietnamese: "h√≤m th∆∞ b∆∞u ƒëi·ªán" },
    { id: 707, lesson: 7, kanji: "Ëä±", hiragana: "„ÅØ„Å™", romaji: "hana", vietnamese: "hoa" },
    { id: 708, lesson: 7, kanji: "Áä¨", hiragana: "„ÅÑ„Å¨", romaji: "inu", vietnamese: "ch√≥" },
    { id: 709, lesson: 7, kanji: "Èñì", hiragana: "„ÅÇ„ÅÑ„Å†", romaji: "aida", vietnamese: "gi·ªØa" },
    { id: 710, lesson: 7, kanji: "‰∏ä", hiragana: "„ÅÜ„Åà", romaji: "ue", vietnamese: "tr√™n" },
    { id: 711, lesson: 7, kanji: "‰∏ã", hiragana: "„Åó„Åü", romaji: "shita", vietnamese: "d∆∞·ªõi" },
    { id: 712, lesson: 7, kanji: "Ëøë„Åè", hiragana: "„Å°„Åã„Åè", romaji: "chikaku", vietnamese: "g·∫ßn" },
    { id: 713, lesson: 7, kanji: "Èö£", hiragana: "„Å®„Å™„Çä", romaji: "tonari", vietnamese: "b√™n c·∫°nh" },
    { id: 714, lesson: 7, kanji: "‰∏≠", hiragana: "„Å™„Åã", romaji: "naka", vietnamese: "trong" },
    { id: 715, lesson: 7, kanji: "Â§ñ", hiragana: "„Åù„Å®", romaji: "soto", vietnamese: "ngo√†i" },
    { id: 716, lesson: 7, kanji: "Ââç", hiragana: "„Åæ„Åà", romaji: "mae", vietnamese: "tr∆∞·ªõc" },
    { id: 717, lesson: 7, kanji: "Âæå„Çç", hiragana: "„ÅÜ„Åó„Çç", romaji: "ushiro", vietnamese: "sau" },
    { id: 718, lesson: 7, kanji: "Ê®™", hiragana: "„Çà„Åì", romaji: "yoko", vietnamese: "c·∫°nh" },
    { id: 719, lesson: 7, kanji: "Ëøé„Åà„Å´Ë°å„Åç„Åæ„Åô", hiragana: "„ÇÄ„Åã„Åà„Å´„ÅÑ„Åç„Åæ„Åô", romaji: "mukae ni ikimasu", vietnamese: "ƒëi ƒë√≥n" },
    { id: 720, lesson: 7, hiragana: "„ÅÑ„Åæ„Åô", romaji: "imasu", vietnamese: "c√≥, ·ªü (ng∆∞·ªùi, ƒë·ªông v·∫≠t)" },
    { id: 721, lesson: 7, hiragana: "„ÇÇ„Åó„ÇÇ„Åó", romaji: "moshi moshi", vietnamese: "al√¥" },
    { id: 722, lesson: 7, hiragana: "„ÅÑ„Åô", romaji: "isu", vietnamese: "gh·∫ø" },
    { id: 723, lesson: 7, katakana: "„ÉÜ„Éº„Éñ„É´", romaji: "teeburu", vietnamese: "b√†n" },
    { id: 724, lesson: 7, kanji: "ÈõªÂ≠ê„É¨„É≥„Ç∏", hiragana: "„Åß„Çì„Åó„É¨„É≥„Ç∏", romaji: "denshi renji", vietnamese: "l√≤ vi s√≥ng" },
    { id: 725, lesson: 7, kanji: "ÂÜ∑ËîµÂ∫´", hiragana: "„Çå„ÅÑ„Åû„ÅÜ„Åì", romaji: "reizouko", vietnamese: "t·ªß l·∫°nh" },
    { id: 726, lesson: 7, kanji: "Á†ÇÁ≥ñ", hiragana: "„Åï„Å®„ÅÜ", romaji: "satou", vietnamese: "ƒë∆∞·ªùng" },
    { id: 727, lesson: 7, kanji: "Â°©", hiragana: "„Åó„Åä", romaji: "shio", vietnamese: "mu·ªëi" },
    { id: 728, lesson: 7, kanji: "ÈÜ¨Ê≤π", hiragana: "„Åó„Çá„ÅÜ„ÇÜ", romaji: "shouyu", vietnamese: "t∆∞∆°ng (x√¨ d·∫ßu)" },
    { id: 729, lesson: 7, katakana: "„Ç≥„ÉÉ„Éó", romaji: "koppu", vietnamese: "c·ªëc" },
    { id: 730, lesson: 7, kanji: "Áöø", hiragana: "„Åï„Çâ", romaji: "(o)sara", vietnamese: "ƒëƒ©a" },
    { id: 731, lesson: 7, katakana: "„Çπ„Éó„Éº„É≥", romaji: "supuun", vietnamese: "th√¨a" },
    { id: 732, lesson: 7, katakana: "„Éä„Ç§„Éï", romaji: "naifu", vietnamese: "dao" },
    { id: 733, lesson: 7, katakana: "„Éï„Ç©„Éº„ÇØ", romaji: "fooku", vietnamese: "nƒ©a" },
    { id: 734, lesson: 7, kanji: "ÁÆ∏", hiragana: "„ÅØ„Åó", romaji: "hashi", vietnamese: "ƒë≈©a" },
    { id: 735, lesson: 7, kanji: "Êº¢Â≠ó", hiragana: "„Åã„Çì„Åò", romaji: "kanji", vietnamese: "ch·ªØ H√°n" },
    { id: 736, lesson: 7, hiragana: "„Å©„Çå", romaji: "dore", vietnamese: "c√°i n√†o (trong ba ho·∫∑c nhi·ªÅu h∆°n)" },
    { id: 737, lesson: 7, hiragana: "„Å©„ÅÆ", romaji: "dono", vietnamese: "n√†o (+ danh t·ª´)" },
    { id: 738, lesson: 7, kanji: "Ê¥ó„ÅÑ„Åæ„Åô", hiragana: "„ÅÇ„Çâ„ÅÑ„Åæ„Åô", romaji: "araimasu", vietnamese: "r·ª≠a" },
    { id: 739, lesson: 7, kanji: "ÁΩÆ„Åç„Åæ„Åô", hiragana: "„Åä„Åç„Åæ„Åô", romaji: "okimasu", vietnamese: "ƒë·ªÉ, ƒë·∫∑t" },
    { id: 740, lesson: 7, kanji: "Êõ∏„Åç„Åæ„Åô", hiragana: "„Åã„Åç„Åæ„Åô", romaji: "kakimasu", vietnamese: "vi·∫øt" },
    { id: 741, lesson: 7, kanji: "Ë≤∏„Åó„Åæ„Åô", hiragana: "„Åã„Åó„Åæ„Åô", romaji: "kashimasu", vietnamese: "cho m∆∞·ª£n" },
    { id: 742, lesson: 7, kanji: "ËÅû„Åç„Åæ„Åô", hiragana: "„Åç„Åç„Åæ„Åô", romaji: "kikimasu", vietnamese: "nghe, h·ªèi" },
    { id: 743, lesson: 7, kanji: "Âàá„Çä„Åæ„Åô", hiragana: "„Åç„Çä„Åæ„Åô", romaji: "kirimasu", vietnamese: "c·∫Øt" },
    { id: 744, lesson: 7, kanji: "‰Ωø„ÅÑ„Åæ„Åô", hiragana: "„Å§„Åã„ÅÑ„Åæ„Åô", romaji: "tsukaimasu", vietnamese: "d√πng, s·ª≠ d·ª•ng" },
    { id: 745, lesson: 7, kanji: "Êâã‰ºù„ÅÑ„Åæ„Åô", hiragana: "„Å¶„Å§„Å†„ÅÑ„Åæ„Åô", romaji: "tetsudaimasu", vietnamese: "gi√∫p" },
    { id: 746, lesson: 7, kanji: "Âèñ„Çä„Åæ„Åô", hiragana: "„Å®„Çä„Åæ„Åô", romaji: "torimasu", vietnamese: "l·∫•y" },
    { id: 747, lesson: 7, kanji: "ÊåÅ„Å£„Å¶Ë°å„Åç„Åæ„Åô", hiragana: "„ÇÇ„Å£„Å¶„ÅÑ„Åç„Åæ„Åô", romaji: "motte ikimasu", vietnamese: "mang ƒëi" },
    { id: 748, lesson: 7, hiragana: "„Çè„Åã„Çä„Åæ„Åô", romaji: "wakarimasu", vietnamese: "hi·ªÉu" },
    { id: 749, lesson: 7, kanji: "Âá∫„Åó„Åæ„Åô", hiragana: "„Å†„Åó„Åæ„Åô", romaji: "dashimasu", vietnamese: "l·∫•y ra, ƒë∆∞a ra, n·ªôp" },
    { id: 750, lesson: 7, kanji: "ÂÖ•„Çå„Åæ„Åô", hiragana: "„ÅÑ„Çå„Åæ„Åô", romaji: "iremasu", vietnamese: "cho v√†o" },
    { id: 751, lesson: 7, kanji: "Êïô„Åà„Åæ„Åô", hiragana: "„Åä„Åó„Åà„Åæ„Åô", romaji: "oshiemasu", vietnamese: "d·∫°y, ch·ªâ" },
    { id: 752, lesson: 7, hiragana: "„Åü„Åè„Åï„Çì", romaji: "takusan", vietnamese: "nhi·ªÅu" },
    { id: 753, lesson: 7, hiragana: "„Åô„Åø„Åæ„Åõ„Çì„Åå", romaji: "sumimasen ga", vietnamese: "xin l·ªói,... (d√πng khi b·∫Øt ƒë·∫ßu c√¢u chuy·ªán)" },
    { id: 754, lesson: 7, hiragana: "„ÅÇ„ÅÇ„ÄÅ„Åì„Çå„Åß„Åô„Å≠", romaji: "aa, kore desu ne", vietnamese: "A, c√°i n√†y c√≥ ph·∫£i kh√¥ng." },
    { id: 755, lesson: 7, hiragana: "„ÅÑ„ÅÑ„Åß„Åô„Çà", romaji: "ii desu yo", vietnamese: "ƒë∆∞·ª£c ch·ª©" },
    { id: 756, lesson: 7, kanji: "Ê≠å", hiragana: "„ÅÜ„Åü", romaji: "uta", vietnamese: "b√†i h√°t" },
    { id: 757, lesson: 7, katakana: "„ÇÆ„Çø„Éº", romaji: "gitaa", vietnamese: "ƒë√†n ghi ta" },
    { id: 758, lesson: 7, kanji: "Âè∞ÊâÄ", hiragana: "„Å†„ÅÑ„Å©„Åì„Çç", romaji: "daidokoro", vietnamese: "b·∫øp" },
    { id: 759, lesson: 7, katakana: "„Åü„Å∞„Åì", romaji: "tabako", vietnamese: "thu·ªëc l√°" },
    { id: 760, lesson: 7, kanji: "ÈõªË©±", hiragana: "„Åß„Çì„Çè", romaji: "denwa", vietnamese: "ƒëi·ªán tho·∫°i" },
    { id: 761, lesson: 7, katakana: "„Éî„Ç∂", romaji: "piza", vietnamese: "b√°nh pizza" },
    { id: 762, lesson: 7, kanji: "Á™ì", hiragana: "„Åæ„Å©", romaji: "mado", vietnamese: "c·ª≠a s·ªï" },
    { id: 763, lesson: 7, kanji: "Ê≠å„ÅÑ„Åæ„Åô", hiragana: "„ÅÜ„Åü„ÅÑ„Åæ„Åô", romaji: "utaimasu", vietnamese: "h√°t" },
    { id: 764, lesson: 7, kanji: "Âê∏„ÅÑ„Åæ„Åô", hiragana: "„Åô„ÅÑ„Åæ„Åô", romaji: "suimasu", vietnamese: "h√∫t" },
    { id: 765, lesson: 7, kanji: "Ë©±„Åó„Åæ„Åô", hiragana: "„ÅØ„Å™„Åó„Åæ„Åô", romaji: "hanashimasu", vietnamese: "n√≥i chuy·ªán" },
    { id: 766, lesson: 7, kanji: "Âºæ„Åç„Åæ„Åô", hiragana: "„Å≤„Åç„Åæ„Åô", romaji: "hikimasu", vietnamese: "ch∆°i (nh·∫°c c·ª• c√≥ d√¢y)" },
    { id: 767, lesson: 7, kanji: "ÊåÅ„Å°„Åæ„Åô", hiragana: "„ÇÇ„Å°„Åæ„Åô", romaji: "mochimasu", vietnamese: "c·∫ßm, mang" },
    { id: 768, lesson: 7, kanji: "Èñã„Åë„Åæ„Åô", hiragana: "„ÅÇ„Åë„Åæ„Åô", romaji: "akemasu", vietnamese: "m·ªü" },
    { id: 769, lesson: 7, kanji: "Èñâ„ÇÅ„Åæ„Åô", hiragana: "„Åó„ÇÅ„Åæ„Åô", romaji: "shimemasu", vietnamese: "ƒë√≥ng" },
    { id: 770, lesson: 7, hiragana: "„Åã„Åë„Åæ„Åô", romaji: "kakemasu", vietnamese: "g·ªçi (ƒëi·ªán tho·∫°i)" },
    { id: 771, lesson: 7, kanji: "ÊåÅ„Å£„Å¶Êù•„Åæ„Åô", hiragana: "„ÇÇ„Å£„Å¶„Åç„Åæ„Åô", romaji: "motte kimasu", vietnamese: "mang ƒë·∫øn" },
    { id: 772, lesson: 7, kanji: "„ÅäÈ°ò„ÅÑ„Åó„Åæ„Åô", hiragana: "„Åä„Å≠„Åå„ÅÑ„Åó„Åæ„Åô", romaji: "onegaishimasu", vietnamese: "nh·ªù anh/ch·ªã" },

    // *** T·ª™ V·ª∞NG M·ªöI T·ª™ ·∫¢NH CH·ª§P V·ªû GHI ***
    { id: 773, lesson: 7, kanji: "Â∑¶", hiragana: "„Å≤„Å†„Çä", romaji: "hidari", vietnamese: "b√™n tr√°i" },
    { id: 774, lesson: 7, kanji: "Âè≥", hiragana: "„Åø„Åé", romaji: "migi", vietnamese: "b√™n ph·∫£i" },
    { id: 775, lesson: 7, hiragana: "„ÅØ„Åï„Åø", romaji: "hasami", vietnamese: "c√°i k√©o" },
    { id: 776, lesson: 7, katakana: "„Éë„É≥", romaji: "pan", vietnamese: "b√°nh m√¨" },
    { id: 777, lesson: 7, kanji: "ÂæÖ„Å°„Åæ„Åô", hiragana: "„Åæ„Å°„Åæ„Åô", romaji: "machimasu", vietnamese: "ƒë·ª£i" },
    { id: 778, lesson: 7, kanji: "Á´ã„Å°„Åæ„Åô", hiragana: "„Åü„Å°„Åæ„Åô", romaji: "tachimasu", vietnamese: "ƒë·ª©ng" },
    { id: 779, lesson: 7, kanji: "Ë≤∑„ÅÑ„Åæ„Åô", hiragana: "„Åã„ÅÑ„Åæ„Åô", romaji: "kaimasu", vietnamese: "mua" },
    { id: 780, lesson: 7, kanji: "Ë™≠„Åø„Åæ„Åô", hiragana: "„Çà„Åø„Åæ„Åô", romaji: "yomimasu", vietnamese: "ƒë·ªçc" },
    { id: 781, lesson: 7, kanji: "ÊÄ•„Åé„Åæ„Åô", hiragana: "„ÅÑ„Åù„Åé„Åæ„Åô", romaji: "isogimasu", vietnamese: "v·ªôi" }
];

// --- PH·∫¶N LOGIC C·ª¶A TRANG (GI·ªÆ NGUY√äN) ---
document.addEventListener('DOMContentLoaded', () => {
    // DOM Elements
    const vocabContent = document.getElementById('vocab-content');
    const showVocabBtn = document.getElementById('show-vocab-btn');
    const showQuizBtn = document.getElementById('show-quiz-btn');
    const vocabView = document.getElementById('vocab-view');
    const quizView = document.getElementById('quiz-view');
    const startQuizSessionBtn = document.getElementById('start-quiz-session-btn');
    const resetProgressBtn = document.getElementById('reset-progress');

    const completedCountEl = document.getElementById('completed-count');
    const totalCountEl = document.getElementById('total-count');
    const progressBar = document.getElementById('progress-bar');

    const quizStartScreen = document.getElementById('quiz-start-screen');
    const quizContainer = document.getElementById('quiz-container');
    const quizCompleteMessage = document.getElementById('quiz-complete-message');

    const questionEl = document.getElementById('question');
    const optionsEl = document.getElementById('options');
    const explanationEl = document.getElementById('explanation');
    const nextQuestionBtn = document.getElementById('next-question-btn');

    // Quiz state variables
    let masterQuestionPool = [];
    let remainingQuestionIds = [];
    let currentSessionQuestions = [];
    let currentQuestionIndex = 0;

    // Key ƒë·ªÉ l∆∞u ti·∫øn ƒë·ªô v√†o localStorage
    const progressKey = 'japaneseQuizProgress_L4_L7_PDFList'; // Updated Key

    // --- Data & State Management ---

    function generateQuestionPool() {
        const pool = [];
        let questionIdCounter = 0;
        vocabulary.forEach(word => {
            // Type 1: JP -> VN
            pool.push({
                qId: questionIdCounter++,
                wordId: word.id,
                lesson: word.lesson,
                type: 'JP_TO_VN',
                questionText: `Nghƒ©a c·ªßa t·ª´ „Äå${word.kanji || word.katakana || word.hiragana}„Äç l√† g√¨?`,
                correctAnswer: word.vietnamese,
                options: [word.vietnamese]
            });
            // Type 2: VN -> JP
            pool.push({
                qId: questionIdCounter++,
                wordId: word.id,
                lesson: word.lesson,
                type: 'VN_TO_JP',
                questionText: `T·ª´ n√†o trong ti·∫øng Nh·∫≠t c√≥ nghƒ©a l√† "${word.vietnamese}"?`,
                correctAnswer: word.kanji || word.katakana || word.hiragana,
                options: [word.kanji || word.katakana || word.hiragana]
            });
             // Type 3: KANJI -> KANA (if applicable and different)
            if (word.kanji && word.hiragana && word.kanji !== word.hiragana) {
                pool.push({
                    qId: questionIdCounter++,
                    wordId: word.id,
                    lesson: word.lesson,
                    type: 'KANJI_TO_KANA',
                    questionText: `C√°ch ƒë·ªçc Hiragana c·ªßa „Äå${word.kanji}„Äç l√† g√¨?`,
                    correctAnswer: word.hiragana,
                    options: [word.hiragana]
                });
            }
        });
        return pool;
    }

    function loadProgress() {
        const savedProgress = localStorage.getItem(progressKey);
        masterQuestionPool = generateQuestionPool();

        if (savedProgress) {
            remainingQuestionIds = JSON.parse(savedProgress);
             // Ensure remaining IDs are valid based on the current pool
            remainingQuestionIds = remainingQuestionIds.filter(id => masterQuestionPool.some(q => q.qId === id));
            saveProgress(); // Save cleaned progress
        } else {
            remainingQuestionIds = masterQuestionPool.map(q => q.qId);
        }
        updateProgressUI();
    }

    function saveProgress() {
        localStorage.setItem(progressKey, JSON.stringify(remainingQuestionIds));
    }

    function resetProgress() {
        if (confirm('B·∫°n c√≥ ch·∫Øc mu·ªën xo√° to√†n b·ªô ti·∫øn ƒë·ªô v√† b·∫Øt ƒë·∫ßu l·∫°i?')) {
            localStorage.removeItem(progressKey);
            loadProgress();
            showView('quiz');
        }
    }

    // --- UI Update Functions ---

    function displayVocabulary() {
        const selectedFilters = Array.from(document.querySelectorAll('input[name="vocab-filter"]:checked')).map(cb => cb.value);

        vocabContent.innerHTML = '';
        const lessons = {};

        const filteredVocab = vocabulary.filter(word => {
            if (selectedFilters.length === 0) return true;
            let matchesFilter = false;
            if (selectedFilters.includes('kanji') && word.kanji) matchesFilter = true;
            // Check for Hiragana ONLY if no Kanji/Katakana present OR if Hiragana is explicitly defined and different from Kanji
            if (!matchesFilter && selectedFilters.includes('hiragana') && word.hiragana && (!word.kanji || word.kanji === word.hiragana) && !word.katakana) matchesFilter = true;
            if (!matchesFilter && selectedFilters.includes('katakana') && word.katakana) matchesFilter = true;
            // Special case: Kanji exists, but filter includes Hiragana (show Kanji with Furigana)
             if (!matchesFilter && selectedFilters.includes('hiragana') && word.kanji && word.hiragana && word.kanji !== word.hiragana) matchesFilter = true;
            return matchesFilter;
        });


        filteredVocab.forEach(word => {
            if (!lessons[word.lesson]) {
                lessons[word.lesson] = [];
            }
            lessons[word.lesson].push(word);
        });

        const sortedLessonKeys = Object.keys(lessons).sort((a, b) => parseInt(a) - parseInt(b));

        for (const lessonNum of sortedLessonKeys) {
            const group = document.createElement('div');
            group.className = 'lesson-group';
            group.innerHTML = `<h3>B√†i ${lessonNum}</h3>`;
            const list = document.createElement('ul');
            list.className = 'vocab-list';
            lessons[lessonNum].forEach(word => {
                const item = document.createElement('li');
                item.className = 'vocab-item';

                let jpDisplay;
                 // Use ruby for furigana if kanji and hiragana exist and differ
                if (word.kanji && word.hiragana && word.kanji !== word.hiragana) {
                     jpDisplay = `<ruby>${word.kanji}<rt>${word.hiragana}</rt></ruby>`;
                }
                // Display Katakana if available (usually no Kanji)
                else if (word.katakana) {
                     jpDisplay = word.katakana;
                 }
                 // Display Hiragana if available (could be standalone or same as Kanji)
                 else if (word.hiragana) {
                     jpDisplay = word.hiragana;
                 }
                 // Fallback to Kanji if only Kanji exists
                 else {
                     jpDisplay = word.kanji || ''; // Fallback to empty string if nothing
                 }


                item.innerHTML = `
                    <div class="vocab-jp">
                        ${jpDisplay}
                        <span class="kana">${word.romaji || ''}</span>
                    </div>
                    <div class="vocab-vi">${word.vietnamese}</div>
                `;
                list.appendChild(item);
            });
            group.appendChild(list);
            vocabContent.appendChild(group);
        }
    }

    function showView(viewName) {
        vocabView.classList.remove('active');
        quizView.classList.remove('active');
        showVocabBtn.classList.remove('active');
        showQuizBtn.classList.remove('active');

        if (viewName === 'vocab') {
            vocabView.classList.add('active');
            showVocabBtn.classList.add('active');
            displayVocabulary(); // Refresh vocab list when switching to this view
        } else {
            quizView.classList.add('active');
            showQuizBtn.classList.add('active');
            quizContainer.style.display = 'none';
            quizStartScreen.style.display = 'block';
            quizCompleteMessage.style.display = 'none';
            if (masterQuestionPool.length > 0 && remainingQuestionIds.length === 0) { // Check if pool is generated
                 quizStartScreen.style.display = 'none';
                 quizCompleteMessage.style.display = 'block';
            } else if (masterQuestionPool.length === 0) { // Initial load state
                quizStartScreen.style.display = 'block';
                quizCompleteMessage.style.display = 'none';
            }
        }
    }

    function updateProgressUI() {
        const totalQuestions = masterQuestionPool.length;
        // Ensure completedCount doesn't go negative if remaining IDs somehow exceed total
        const completedCount = Math.max(0, totalQuestions - remainingQuestionIds.length);

        totalCountEl.textContent = totalQuestions;
        completedCountEl.textContent = completedCount;

        const progressPercentage = totalQuestions > 0 ? (completedCount / totalQuestions) * 100 : 0;
        progressBar.style.width = `${progressPercentage}%`;
    }

    // --- Quiz Logic ---
    function shuffleArray(array) {
        for (let i = array.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [array[i], array[j]] = [array[j], array[i]];
        }
        return array;
    }

    function startNewSession() {
        if (remainingQuestionIds.length === 0) {
            // Check if master pool has questions to avoid alert on empty initial load
            if(masterQuestionPool.length > 0) {
              alert("Ch√∫c m·ª´ng! B·∫°n ƒë√£ ho√†n th√†nh t·∫•t c·∫£ c√°c c√¢u h·ªèi.");
            }
            showView('quiz'); // Go back to quiz start/complete screen
            return;
        }

        const remainingQuestions = masterQuestionPool.filter(q => remainingQuestionIds.includes(q.qId));
        // Take up to 10 questions, or fewer if less than 10 remain
        currentSessionQuestions = shuffleArray([...remainingQuestions]).slice(0, 10);
        currentQuestionIndex = 0;

        quizStartScreen.style.display = 'none';
        quizCompleteMessage.style.display = 'none'; // Hide completion message
        quizContainer.style.display = 'block';

        displayQuestion();
    }

    function getDistractor(correctWordId, questionType) {
        let randomWord;
        let distractorText;
        let attempts = 0;
        const maxAttempts = vocabulary.length * 2; // Limit attempts to prevent infinite loop

        do {
            randomWord = vocabulary[Math.floor(Math.random() * vocabulary.length)];
            if (questionType === 'JP_TO_VN') {
                distractorText = randomWord.vietnamese;
            } else if (questionType === 'VN_TO_JP') {
                distractorText = randomWord.kanji || randomWord.katakana || randomWord.hiragana;
            } else { // KANJI_TO_KANA
                distractorText = randomWord.hiragana;
            }
            attempts++;
        // Ensure distractor is valid, not the correct answer's word, and not null/undefined
        } while ((!distractorText || randomWord.id === correctWordId) && attempts < maxAttempts);

        // If after max attempts we still don't have a *unique* distractor, return null
        if (attempts >= maxAttempts && (!distractorText || randomWord.id === correctWordId)) {
            return null;
        }

        return distractorText; // Return the valid distractor text
    }


    function displayQuestion() {
        explanationEl.style.display = 'none';
        nextQuestionBtn.style.display = 'none';

        if (currentQuestionIndex >= currentSessionQuestions.length) {
             alert('Ho√†n th√†nh phi√™n √¥n t·∫≠p!');
             showView('quiz');
             return;
        }

        const currentQuestion = currentSessionQuestions[currentQuestionIndex];
        questionEl.textContent = currentQuestion.questionText;
        optionsEl.innerHTML = '';

        // Start with the correct answer
        let options = [currentQuestion.correctAnswer];
        const addedDistractors = new Set([currentQuestion.correctAnswer]); // Keep track of added options

        // Generate distractors
        let attempts = 0;
        const maxOptionAttempts = vocabulary.length * 3; // Limit attempts to find unique options
        while (options.length < 4 && attempts < maxOptionAttempts) {
            const distractor = getDistractor(currentQuestion.wordId, currentQuestion.type);
            // Add distractor only if it's valid and not already in the options set
            if (distractor && !addedDistractors.has(distractor)) {
                options.push(distractor);
                addedDistractors.add(distractor);
            }
            attempts++;
        }

        // If still not enough options (e.g., very small vocab list), fill with placeholders
         while (options.length < 4) {
            options.push("---"); // Placeholder, ensure it's not the correct answer
            if (options.length === 4 && options.includes("---") && options.indexOf("---") !== options.lastIndexOf("---") && currentQuestion.correctAnswer === "---") {
                 // Extremely unlikely edge case: correct answer is "---" and we added duplicate placeholders
                 // Replace one placeholder to ensure uniqueness if possible
                 const replacement = getDistractor(currentQuestion.wordId, currentQuestion.type) || "???"; // Find another or use ???
                 const firstPlaceholderIndex = options.indexOf("---");
                 if (!options.includes(replacement)) {
                      options[firstPlaceholderIndex] = replacement;
                 }
            }
         }


        shuffleArray(options).forEach(option => {
            const button = document.createElement('button');
            button.textContent = option;
            button.addEventListener('click', () => selectAnswer(option, currentQuestion.correctAnswer));
            optionsEl.appendChild(button);
        });
    }

    function selectAnswer(selectedOption, correctAnswer) {
        const buttons = optionsEl.querySelectorAll('button');
        let isCorrect = selectedOption === correctAnswer;

        buttons.forEach(button => {
            button.disabled = true; // Disable all buttons
            if (button.textContent === correctAnswer) {
                button.classList.add('correct');
            } else if (button.textContent === selectedOption) {
                 // Only add 'incorrect' class if the selected one wasn't the correct one
                 if (!isCorrect) {
                    button.classList.add('incorrect');
                 }
            }
        });

        if (isCorrect) {
            const qIdToRemove = currentSessionQuestions[currentQuestionIndex].qId;
            const indexToRemove = remainingQuestionIds.indexOf(qIdToRemove);
            if (indexToRemove > -1) {
                remainingQuestionIds.splice(indexToRemove, 1);
                saveProgress(); // Save progress only on correct answer
                updateProgressUI(); // Update UI immediately
            }
        }

        showExplanation();
        nextQuestionBtn.style.display = 'inline-block'; // Show next button
    }


    function showExplanation() {
        const questionData = currentSessionQuestions[currentQuestionIndex];
        const word = vocabulary.find(w => w.id === questionData.wordId);

        if (word) { // Check if word exists
            document.getElementById('exp-kanji').textContent = word.kanji || '‚Äì';
            document.getElementById('exp-kana').textContent = word.hiragana || word.katakana || '‚Äì';
            document.getElementById('exp-romaji').textContent = word.romaji || '‚Äì';
            document.getElementById('exp-vi').textContent = word.vietnamese || '‚Äì';
            // Placeholder for examples - you'd need to add example data to your `vocabulary` array
            document.getElementById('exp-sentence-jp').textContent = word.example_jp || "Ch∆∞a c√≥ v√≠ d·ª•";
            document.getElementById('exp-sentence-romaji').textContent = word.example_romaji || "";
            document.getElementById('exp-sentence-vi').textContent = word.example_vi || "";

            explanationEl.style.display = 'block';
        } else {
             explanationEl.style.display = 'none'; // Hide if word data not found
        }
    }

    function handleNextQuestion() {
        currentQuestionIndex++;
        if (currentQuestionIndex < currentSessionQuestions.length) {
            displayQuestion();
        } else {
            alert('Ho√†n th√†nh phi√™n √¥n t·∫≠p!');
            showView('quiz'); // Go back to quiz view start/complete screen
        }
    }

    // --- Event Listeners ---
    showVocabBtn.addEventListener('click', () => showView('vocab'));
    showQuizBtn.addEventListener('click', () => showView('quiz'));
    startQuizSessionBtn.addEventListener('click', startNewSession);
    nextQuestionBtn.addEventListener('click', handleNextQuestion);
    resetProgressBtn.addEventListener('click', resetProgress);
    document.querySelectorAll('input[name="vocab-filter"]').forEach(checkbox => {
        checkbox.addEventListener('change', displayVocabulary);
    });

    // --- Initial Load ---
    loadProgress(); // Load progress and generate pool first
    showView('vocab'); // Then show the initial view
});
</script>

</body>
</html>